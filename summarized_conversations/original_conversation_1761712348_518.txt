{'role': 'assistant', 'content': 'Let\'s fix the medicalRecord.controller.js file:\n\n<function_calls>\n<full-file-rewrite file_path="src/controllers/medicalRecord.controller.js">\nconst MedicalRecord = require(\'../models/MedicalRecord.model\');\nconst { successResponse, errorResponse } = require(\'../utils/response\');\nconst logger = require(\'../utils/logger\');\n\nclass MedicalRecordController {\n  /**\n   * Create a new medical record\n   */\n  async createMedicalRecord(req, res) {\n    try {\n      const { patientId, doctorId, hospitalId, recordType, recordDate, notes, fileUrl } = req.body;\n      \n      // Create medical record\n      const medicalRecord = await MedicalRecord.create({\n        patientId,\n        doctorId,\n        hospitalId,\n        recordType,\n        recordDate,\n        notes,\n        fileUrl,\n      });\n      \n      return successResponse(res, {\n        message: \'Medical record created successfully\',\n        data: medicalRecord,\n      }, 201);\n    } catch (error) {\n      logger.error(\'Create medical record error:\', error);\n      return errorResponse(res, {\n        message: \'Failed to create medical record\',\n        error: error.message,\n      }, 500);\n    }\n  }\n\n  /**\n   * Get medical record by ID\n   */\n  async getMedicalRecord(req, res) {\n    try {\n      const { id } = req.params;\n      \n      // Find medical record\n      const medicalRecord = await MedicalRecord.findByPk(id);\n      \n      if (!medicalRecord) {\n        return errorResponse(res, {\n          message: \'Medical record not found\',\n        }, 404);\n      }\n      \n      return successResponse(res, {\n        message: \'Medical record retrieved successfully\',\n        data: medicalRecord,\n      });\n    } catch (error) {\n      logger.error(\'Get medical record error:\', error);\n      return errorResponse(res, {\n        message: \'Failed to retrieve medical record\',\n        error: error.message,\n      }, 500);\n    }\n  }\n\n  /**\n   * Update medical record\n   */\n  async updateMedicalRecord(req, res) {\n    try {\n      const { id } = req.params;\n      const { recordType, recordDate, notes, fileUrl } = req.body;\n      \n      // Find medical record\n      const medicalRecord = await MedicalRecord.findByPk(id);\n      \n      if (!medicalRecord) {\n        return errorResponse(res, {\n          message: \'Medical record not found\',\n        }, 404);\n      }\n      \n      // Update medical record\n      await medicalRecord.update({\n        recordType,\n        recordDate,\n        notes,\n        fileUrl,\n      });\n      \n      return successResponse(res, {\n        message: \'Medical record updated successfully\',\n        data: medicalRecord,\n      });\n    } catch (error) {\n      logger.error(\'Update medical record error:\', error);\n      return errorResponse(res, {\n        message: \'Failed to update medical record\',\n        error: error.message,\n      }, 500);\n    }\n  }\n\n  /**\n   * Delete medical record\n   */\n  async deleteMedicalRecord(req, res) {\n    try {\n      const { id } = req.params;\n      \n      // Find medical record\n      const medicalRecord = await MedicalRecord.findByPk(id);\n      \n      if (!medicalRecord) {\n        return errorResponse(res, {\n          message: \'Medical record not found\',\n        }, 404);\n      }\n      \n      // Delete medical record\n      await medicalRecord.destroy();\n      \n      return successResponse(res, {\n        message: \'Medical record deleted successfully\',\n      });\n    } catch (error) {\n      logger.error(\'Delete medical record error:\', error);\n      return errorResponse(res, {\n        message: \'Failed to delete medical record\',\n        error: error.message,\n      }, 500);\n    }\n  }\n\n  /**\n   * Get all medical records for a patient\n   */\n  async getPatientMedicalRecords(req, res) {\n    try {\n      const { patientId } = req.params;\n      const { page = 1, limit = 10, recordType } = req.query;\n      \n      // Build where clause\n      const where = { patientId };\n      if (recordType) where.recordType = recordType;\n      \n      // Get medical records with pagination\n      const medicalRecords = await MedicalRecord.findAndCountAll({\n        where,\n        limit: parseInt(limit, 10),\n        offset: (parseInt(page, 10) - 1) * parseInt(limit, 10),\n        order: [[\'recordDate\', \'DESC\']],\n      });\n      \n      return successResponse(res, {\n        message: \'Medical records retrieved successfully\',\n        data: medicalRecords.rows,\n        pagination: {\n          currentPage: parseInt(page, 10),\n          totalPages: Math.ceil(medicalRecords.count / parseInt(limit, 10)),\n          totalRecords: medicalRecords.count,\n        },\n      });\n    } catch (error) {\n      logger.error(\'Get patient medical records error:\', error);\n      return errorResponse(res, {\n        message: \'Failed to retrieve medical records\',\n        error: error.message,\n      }, 500);\n    }\n  }\n}\n\nmodule.exports = new MedicalRecordController();\n</full-file-rewrite>\n</function_calls>'}