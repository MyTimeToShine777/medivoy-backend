model Prescription {
  prescriptionId          String    @id @default(uuid()) @db.Uuid
  appointmentId           String?   @db.Uuid @unique  // Unique for one-to-one relation
  userId                  String    @db.Uuid
  patientId               String    @db.Uuid
  doctorId                String?   @db.Uuid
  hospitalId              String?   @db.Uuid
  prescriptionNumber      String    @unique @db.VarChar(100)
  type                    String    @default("medication") @db.VarChar(50)
  status                  String    @default("draft") @db.VarChar(50)
  medications             Json
  dosageInstructions      String?   @db.Text
  frequency               String?   @db.VarChar(50)
  duration                Int?
  durationUnit            String    @default("days") @db.VarChar(20)
  refillsAllowed          Int       @default(0)
  refillsUsed             Int       @default(0)
  validFrom               DateTime  @db.Date
  validUntil              DateTime? @db.Date
  notes                   String?   @db.Text
  isActive                Boolean   @default(true)
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt
  
  // Relations (only define fields, references, onDelete on one side)
  appointment             Appointment?  // relation without fields, references here
  user                    User      @relation(fields: [userId], references: [userId], onDelete: Cascade)
  patient                 Patient   @relation(fields: [patientId], references: [patientId], onDelete: Cascade)
  doctor                  Doctor?   @relation(fields: [doctorId], references: [doctorId], onDelete: SetNull)
  
  @@index([appointmentId])
  @@index([userId])
  @@index([patientId])
  @@index([doctorId])
  @@index([prescriptionNumber])
  @@index([status])
  @@map("prescriptions")
}
