model Subscription {
  subscriptionId          String    @id @default(uuid()) @db.Uuid
  userId                  String    @db.Uuid
  planId                  String    @db.Uuid
  status                  String    @default("active") @db.VarChar(50)
  startDate               DateTime  @db.Date
  endDate                 DateTime? @db.Date
  currentPeriodStart      DateTime  @db.Date
  currentPeriodEnd        DateTime  @db.Date
  trialStart              DateTime? @db.Date
  trialEnd                DateTime? @db.Date
  cancelledAt             DateTime?
  cancellationReason      String?   @db.Text
  pausedAt                DateTime?
  resumedAt               DateTime?
  billingCycle            String    @default("monthly") @db.VarChar(50)
  amount                  Decimal   @db.Decimal(12, 2)
  currency                String    @default("USD") @db.VarChar(3)
  paymentMethod           String?   @db.VarChar(50)
  autoRenew               Boolean   @default(true)
  renewalCount            Int       @default(0)
  lastRenewedAt           DateTime?
  nextBillingDate         DateTime?
  gracePeriodEndsAt       DateTime?
  metadata                Json?
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt
  
  plan                    SubscriptionPlan @relation(fields: [planId], references: [planId], onDelete: Restrict)
  
  @@index([userId])
  @@index([planId])
  @@index([status])
  @@index([nextBillingDate])
  @@map("subscriptions")
}
